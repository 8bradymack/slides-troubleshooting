<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calvary Slides Troubleshooting</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: linear-gradient(135deg, #0a192f 0%, #112240 50%, #1a365d 100%);
            background-attachment: fixed;
            color: #e2e8f0; 
            line-height: 1.6; 
            padding-bottom: 60px;
            min-height: 100vh;
        }
        
        header { 
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.1) 0%, rgba(14, 165, 233, 0.1) 100%);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
            color: white; 
            padding: 15px 20px 20px; 
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }
        
        h1 { 
            font-size: 1.5em; 
            margin-bottom: 5px; 
            font-weight: 700;
            background: linear-gradient(135deg, #06b6d4, #0ea5e9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle { font-size: 0.85em; opacity: 0.8; margin-bottom: 15px; color: #cbd5e1; }
        
        .search-container { max-width: 600px; margin: 0 auto; padding: 0 20px; position: relative; }
        #searchBar { 
            width: 100%; 
            padding: 12px 45px 12px 18px; 
            font-size: 1em; 
            border: 2px solid rgba(6, 182, 212, 0.3);
            background: rgba(26, 10, 46, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 12px; 
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            outline: none; 
            transition: all 0.3s;
            color: white;
        }
        #searchBar::placeholder { color: #64748b; }
        #searchBar:focus { 
            border-color: #06b6d4;
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.1), 0 8px 32px rgba(0,0,0,0.3);
            background: rgba(26, 10, 46, 0.8);
        }
        
        .search-icons-container { position: absolute; right: 30px; top: 50%; transform: translateY(-50%); }
        .search-icon { color: #64748b; font-size: 1.1em; cursor: default; }
        .clear-search { 
            color: #64748b; 
            font-size: 1em; 
            cursor: pointer; 
            background: rgba(51, 65, 85, 0.8);
            border-radius: 50%; 
            width: 24px; 
            height: 24px; 
            display: none; 
            align-items: center; 
            justify-content: center; 
            transition: all 0.2s; 
            font-weight: bold;
        }
        .clear-search:hover { background: rgba(71, 85, 105, 0.9); color: #cbd5e1; }
        .clear-search.active { display: flex; }
        
        .suggestions-dropdown { 
            position: absolute; 
            top: 100%; 
            left: 20px; 
            right: 20px; 
            background: rgba(26, 10, 46, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-radius: 12px; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            margin-top: 8px; 
            max-height: 400px; 
            overflow-y: auto; 
            display: none; 
            z-index: 100;
        }
        .suggestions-dropdown.active { display: block; }
        .suggestion-item { 
            padding: 14px 18px; 
            cursor: pointer; 
            border-bottom: 1px solid rgba(6, 182, 212, 0.1);
            transition: all 0.2s;
        }
        .suggestion-item:hover { background: rgba(6, 182, 212, 0.1); }
        .suggestion-item:last-child { border-bottom: none; }
        .suggestion-question { font-weight: 600; color: #06b6d4; font-size: 0.9em; margin-bottom: 5px; }
        .suggestion-preview { font-size: 0.8em; color: #94a3b8; }
        .suggestion-category { 
            display: inline-block; 
            padding: 3px 10px; 
            background: rgba(6, 182, 212, 0.2);
            color: #06b6d4;
            border-radius: 10px; 
            font-size: 0.7em; 
            font-weight: 600; 
            margin-top: 5px;
        }
        
        .highlight { background: rgba(251, 191, 36, 0.3); padding: 2px 4px; border-radius: 3px; font-weight: 600; color: #fbbf24; }
        .search-stats { text-align: center; color: #94a3b8; font-size: 0.95em; margin: 25px 0 15px; }
        
        .recent-searches { max-width: 600px; margin: 20px auto 0; padding: 0 20px; }
        .recent-searches-title { font-size: 0.85em; color: rgba(255,255,255,0.6); margin-bottom: 10px; font-weight: 600; }
        .recent-tag { 
            display: inline-block; 
            padding: 8px 16px; 
            background: rgba(51, 65, 85, 0.6);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 20px; 
            font-size: 0.85em; 
            margin: 4px; 
            cursor: pointer; 
            transition: all 0.2s; 
            color: #cbd5e1;
        }
        .recent-tag:hover { 
            border-color: #06b6d4; 
            background: rgba(6, 182, 212, 0.2);
            color: #06b6d4;
            transform: translateY(-2px); 
        }
        .clear-recent { 
            display: inline-block; 
            padding: 8px 16px; 
            background: transparent; 
            border: none; 
            color: rgba(255,255,255,0.5);
            font-size: 0.85em; 
            cursor: pointer; 
            margin-left: 8px;
            transition: all 0.2s;
        }
        .clear-recent:hover { color: #ef4444; }
        
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        
        .emergency-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .emergency-btn {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(220, 38, 38, 0.1) 100%);
            border: 2px solid rgba(239, 68, 68, 0.4);
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .emergency-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }
        
        .emergency-btn:hover::before {
            left: 100%;
        }
        
        .emergency-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(239, 68, 68, 0.3);
            border-color: #ef4444;
        }
        
        .emergency-btn.display { 
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.2) 0%, rgba(14, 165, 233, 0.1) 100%);
            border-color: rgba(6, 182, 212, 0.4);
        }
        .emergency-btn.display:hover { border-color: #06b6d4; box-shadow: 0 20px 40px rgba(6, 182, 212, 0.3); }
        
        .emergency-btn.slides { 
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.2) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-color: rgba(14, 165, 233, 0.4);
        }
        .emergency-btn.slides:hover { border-color: #0ea5e9; box-shadow: 0 20px 40px rgba(14, 165, 233, 0.3); }
        
        .emergency-icon {
            font-size: 3em;
            margin-bottom: 15px;
            display: block;
        }
        
        .emergency-title {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 8px;
            color: white;
        }
        
        .emergency-subtitle {
            font-size: 0.9em;
            color: #94a3b8;
        }
        
        .categories { 
            display: flex; 
            gap: 12px; 
            flex-wrap: wrap; 
            margin-bottom: 35px; 
            justify-content: center;
        }
        
        .category-btn { 
            padding: 10px 20px; 
            background: rgba(51, 65, 85, 0.6);
            border: 2px solid rgba(6, 182, 212, 0.2);
            border-radius: 30px; 
            cursor: pointer; 
            font-size: 0.9em; 
            transition: all 0.3s; 
            color: #cbd5e1;
            font-weight: 600;
        }
        .category-btn:hover { 
            border-color: #06b6d4; 
            background: rgba(6, 182, 212, 0.2);
            color: #06b6d4;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(6, 182, 212, 0.2);
        }
        .category-btn.active { 
            background: linear-gradient(135deg, #06b6d4, #0ea5e9);
            color: white; 
            border-color: #06b6d4;
            box-shadow: 0 8px 20px rgba(6, 182, 212, 0.4);
        }
        
        .faq-list { display: flex; flex-direction: column; gap: 20px; }
        
        .faq-item { 
            background: rgba(26, 10, 46, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-radius: 16px; 
            padding: 25px; 
            cursor: pointer; 
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .faq-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #06b6d4, #0ea5e9);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .faq-item:hover::before { opacity: 1; }
        
        .faq-item:hover { 
            box-shadow: 0 12px 40px rgba(0,0,0,0.4);
            transform: translateY(-3px);
            border-color: #06b6d4;
            background: rgba(26, 10, 46, 0.8);
        }
        
        .faq-item.pinned { border-left: 4px solid #f59e0b; }
        .faq-item.pinned::before { display: none; }
        
        .faq-question { 
            font-size: 1.2em; 
            font-weight: 600; 
            color: #e2e8f0;
            margin-bottom: 8px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
        }
        
        .faq-category { 
            display: inline-block; 
            padding: 6px 14px; 
            background: rgba(6, 182, 212, 0.2);
            color: #06b6d4;
            border-radius: 12px; 
            font-size: 0.75em; 
            font-weight: 600; 
            margin-top: 10px;
        }
        
        .faq-preview { 
            color: #94a3b8;
            font-size: 0.95em; 
            margin-top: 10px; 
            line-height: 1.6;
        }
        .faq-item.expanded .faq-preview { display: none; }
        
        .faq-answer { 
            margin-top: 20px; 
            padding-top: 20px; 
            border-top: 1px solid rgba(6, 182, 212, 0.2);
            color: #cbd5e1;
            line-height: 1.8; 
            display: none;
        }
        .faq-answer.expanded { display: block; }
        .faq-answer h3 { color: #06b6d4; font-size: 1.1em; margin-top: 20px; margin-bottom: 12px; }
        .faq-answer ul, .faq-answer ol { margin-left: 20px; margin-top: 10px; }
        .faq-answer li { 
            margin-bottom: 10px;
            position: relative;
            padding-left: 10px;
        }
        .faq-answer ol li::before {
            content: '';
            position: absolute;
            left: -20px;
            top: 8px;
            width: 6px;
            height: 6px;
            background: #06b6d4;
            border-radius: 50%;
        }
        .faq-answer strong { color: #06b6d4; }
        
        .step-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin: 8px 0;
            padding: 12px;
            border-radius: 10px;
            transition: all 0.2s;
        }
        
        .step-checkbox:hover {
            background: rgba(6, 182, 212, 0.05);
        }
        
        .step-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            cursor: pointer;
            accent-color: #06b6d4;
            flex-shrink: 0;
        }
        
        .step-checkbox label {
            cursor: pointer;
            flex: 1;
            user-select: none;
        }
        
        .step-checkbox.completed label {
            text-decoration: line-through;
            opacity: 0.6;
        }
        
        .feedback-section {
            margin-top: 25px;
            padding: 20px;
            background: rgba(51, 65, 85, 0.4);
            border-radius: 12px;
            border: 1px solid rgba(6, 182, 212, 0.2);
        }
        
        .feedback-question {
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 12px;
            font-size: 0.95em;
        }
        
        .feedback-buttons {
            display: flex;
            gap: 12px;
        }
        
        .feedback-btn {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid rgba(6, 182, 212, 0.3);
            background: rgba(26, 10, 46, 0.6);
            color: #cbd5e1;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.9em;
        }
        
        .feedback-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        
        .feedback-btn.yes {
            border-color: rgba(34, 197, 94, 0.4);
        }
        
        .feedback-btn.yes:hover {
            background: rgba(34, 197, 94, 0.2);
            border-color: #22c55e;
            color: #4ade80;
        }
        
        .feedback-btn.no {
            border-color: rgba(239, 68, 68, 0.4);
        }
        
        .feedback-btn.no:hover {
            background: rgba(239, 68, 68, 0.2);
            border-color: #ef4444;
            color: #f87171;
        }
        
        .feedback-thanks {
            color: #4ade80;
            font-weight: 600;
            text-align: center;
            padding: 15px;
            display: none;
        }
        
        .feedback-thanks.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .expand-icon { 
            color: #06b6d4;
            font-size: 1.2em; 
            transition: transform 0.3s;
        }
        .faq-item.expanded .expand-icon { transform: rotate(180deg); }
        
        .section-title { 
            font-size: 1.5em; 
            font-weight: 700; 
            color: #e2e8f0;
            margin-bottom: 20px; 
            display: flex; 
            align-items: center; 
            gap: 12px;
        }
        
        .pinned-section { margin-bottom: 50px; }
        .pin-icon { color: #f59e0b; font-size: 1.2em; }
        
        .no-results { 
            text-align: center; 
            padding: 80px 20px; 
            color: #64748b;
            display: none;
        }
        .no-results-icon { font-size: 4em; margin-bottom: 20px; opacity: 0.5; }
        .no-results h2 { font-size: 1.8em; margin-bottom: 15px; color: #94a3b8; }
        
        footer { 
            text-align: center; 
            padding: 40px 20px; 
            color: #64748b;
            font-size: 0.9em; 
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            margin-top: 60px;
            border-top: 1px solid rgba(6, 182, 212, 0.2);
        }
        
        .report-btn { 
            display: inline-block; 
            margin-top: 20px; 
            padding: 14px 35px; 
            background: linear-gradient(135deg, #06b6d4, #0ea5e9);
            color: white; 
            text-decoration: none; 
            border-radius: 12px; 
            font-weight: 600; 
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(6, 182, 212, 0.3);
        }
        .report-btn:hover { 
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(6, 182, 212, 0.4);
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 1.4em; }
            .subtitle { font-size: 0.8em; }
            header { padding: 12px 15px 18px; }
            .emergency-actions { grid-template-columns: 1fr; gap: 15px; }
            .emergency-btn { padding: 20px; }
            .emergency-icon { font-size: 2.2em; }
            .emergency-title { font-size: 1.1em; }
            .emergency-subtitle { font-size: 0.85em; }
            .category-btn { padding: 8px 16px; font-size: 0.85em; }
            .faq-item { padding: 20px; }
            .faq-question { font-size: 1.1em; }
        }
    </style>
</head>
<body>
    <header>
        <h1>📽️ Calvary Slides Setup</h1>
        <p class="subtitle">ProPresenter Troubleshooting Hub</p>
        <div class="search-container">
            <input type="text" id="searchBar" placeholder="Search: 'no display', 'lyrics', 'blank screen'..." autocomplete="off">
            <div class="search-icons-container">
                <span class="search-icon" id="searchIcon">🔍</span>
                <span class="clear-search" id="clearSearch">✕</span>
            </div>
            <div class="suggestions-dropdown" id="suggestionsDropdown"></div>
        </div>
        <div class="recent-searches" id="recentSearches" style="display:none;">
            <div class="recent-searches-title">Recent searches:</div>
            <div id="recentTags"></div>
        </div>
    </header>

    <div class="container">
        <div class="emergency-actions" id="emergencyActions">
            <div class="emergency-btn" data-issue="no-display">
                <span class="emergency-icon">🖥️</span>
                <div class="emergency-title">NO DISPLAY</div>
                <div class="emergency-subtitle">Screens not showing slides</div>
            </div>
            <div class="emergency-btn display" data-issue="wrong-screen">
                <span class="emergency-icon">🔀</span>
                <div class="emergency-title">WRONG SCREEN</div>
                <div class="emergency-subtitle">Output going to wrong display</div>
            </div>
            <div class="emergency-btn slides" data-issue="not-advancing">
                <span class="emergency-icon">⏭️</span>
                <div class="emergency-title">NOT ADVANCING</div>
                <div class="emergency-subtitle">Clicker/remote not working</div>
            </div>
        </div>
        
        <div class="search-stats" id="searchStats"></div>
        
        <div class="categories" id="categories">
            <button class="category-btn active" data-category="all">All</button>
            <button class="category-btn" data-category="Setup">Setup</button>
            <button class="category-btn" data-category="Display">Display</button>
            <button class="category-btn" data-category="ProPresenter">ProPresenter</button>
            <button class="category-btn" data-category="Remote Control">Remote Control</button>
            <button class="category-btn" data-category="Content">Content</button>
        </div>

        <div class="pinned-section" id="pinnedSection">
            <h2 class="section-title"><span class="pin-icon">📌</span>Most Common Issues</h2>
            <div class="faq-list" id="pinnedList"></div>
        </div>

        <div id="allSection">
            <h2 class="section-title">All Troubleshooting Guides</h2>
            <div class="faq-list" id="faqList"></div>
        </div>

        <div class="no-results" id="noResults">
            <div class="no-results-icon">🔍</div>
            <h2>No matches found</h2>
            <p>Try different keywords or use the emergency buttons above</p>
        </div>
    </div>

    <footer>
        <p><strong>Last Updated:</strong> October 2025</p>
        <p>Calvary San Mateo A/V Team</p>
        <a href="#" id="reportBtn" class="report-btn">🔧 Report an Issue</a>
    </footer>

    <div id="contactModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);backdrop-filter:blur(10px);z-index:1000;padding:20px;">
        <div style="max-width:600px;margin:50px auto;background:rgba(30, 41, 59, 0.95);backdrop-filter:blur(20px);border:1px solid rgba(6, 182, 212, 0.3);border-radius:20px;padding:35px;box-shadow:0 20px 60px rgba(0,0,0,0.5);">
            <h2 style="color:#06b6d4;margin-bottom:15px;font-size:1.8em;">Report an Issue</h2>
            <form id="contactForm" action="https://formspree.io/f/xqayyzrr" method="POST">
                <div style="margin-bottom:20px;">
                    <label style="display:block;font-weight:600;margin-bottom:10px;color:#e2e8f0;">Your Name (Optional)</label>
                    <input type="text" name="name" style="width:100%;padding:14px;border:2px solid rgba(6, 182, 212, 0.3);background:rgba(15, 23, 42, 0.6);color:white;border-radius:10px;">
                </div>
                <div style="margin-bottom:20px;">
                    <label style="display:block;font-weight:600;margin-bottom:10px;color:#e2e8f0;">Issue Category</label>
                    <select name="category" style="width:100%;padding:14px;border:2px solid rgba(6, 182, 212, 0.3);background:rgba(15, 23, 42, 0.6);color:white;border-radius:10px;">
                        <option value="">Select...</option>
                        <option>Setup</option>
                        <option>Display</option>
                        <option>ProPresenter</option>
                        <option>Remote Control</option>
                        <option>Content</option>
                        <option>Other</option>
                    </select>
                </div>
                <div style="margin-bottom:25px;">
                    <label style="display:block;font-weight:600;margin-bottom:10px;color:#e2e8f0;">Description *</label>
                    <textarea name="message" required style="width:100%;padding:14px;border:2px solid rgba(6, 182, 212, 0.3);background:rgba(15, 23, 42, 0.6);color:white;border-radius:10px;min-height:150px;"></textarea>
                </div>
                <div style="display:flex;gap:12px;justify-content:flex-end;">
                    <button type="button" id="cancelBtn" style="padding:14px 28px;background:rgba(51, 65, 85, 0.6);color:#cbd5e1;border:2px solid rgba(6, 182, 212, 0.2);border-radius:10px;cursor:pointer;font-weight:600;transition:all 0.3s;">Cancel</button>
                    <button type="submit" style="padding:14px 28px;background:linear-gradient(135deg, #06b6d4, #0ea5e9);color:white;border:none;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 8px 20px rgba(6, 182, 212, 0.3);transition:all 0.3s;">Submit</button>
                </div>
            </form>
            <div id="successMessage" style="display:none;margin-top:20px;padding:18px;background:rgba(34, 197, 94, 0.2);border:1px solid rgba(34, 197, 94, 0.4);border-radius:10px;color:#4ade80;font-weight:600;text-align:center;">✓ Submitted!</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>
    <script>
const faqData=[
{id:1,question:"Complete ProPresenter Setup",category:"Setup",pinned:true,keywords:"startup setup turn on mac mini displaylink sunday morning automation",answer:"<h3>Sunday Morning Setup:</h3><ol><li>Turn on all TVs (including confidence monitor)</li><li>Turn on Mac Mini and log in</li><li>Click <strong>Sunday Setup</strong> automation app (it will automatically:<ul><li>Open Google Drive folder for playlists</li><li>Launch DisplayLink Manager</li><li>Launch ProPresenter</li></ul></li><li>Download the playlist and message from the open Google Drive folder</li><li>Combine the playlist and message files in ProPresenter</li><li>Run through the songs with the band</li><li>Verify HDMI Extender is powered on</li><li>Check all TVs showing slides correctly</li><li>Test clicker/remote batteries</li></ol><h3>⚠️ IMPORTANT:</h3><p><strong>The Sunday Setup app launches DisplayLink before ProPresenter automatically!</strong> This ensures confidence monitor and Camera 4 livestream overlay work properly.</p>"},
{id:2,question:"Screens show nothing / blank display",category:"Display",pinned:true,keywords:"blank black no display nothing showing screen tvs hdmi extender",answer:"<h3>Fix Blank Display:</h3><ol><li>Check all TVs are ON (look for power light)</li><li>Verify Mac Mini is awake (not in sleep mode)</li><li>Check HDMI Extender power (both sender and receiver)</li><li>In ProPresenter: Check 'Enable Output' is ON</li><li>Try toggling output OFF then ON</li><li>Check correct input selected on each TV</li></ol><h3>If ALL TVs are blank:</h3><ul><li>HDMI Extender issue - check power on both ends</li><li>Check HDMI cable from Mac Mini to extender sender</li><li>Power cycle the extender (unplug 10 seconds, plug back in)</li></ul><h3>If ONE TV is blank:</h3><ul><li>Check that specific TV's input source</li><li>Check HDMI cable at that TV</li><li>Try different HDMI port on TV</li></ul>"},
{id:3,question:"Slides going to wrong screen",category:"Display",pinned:true,keywords:"wrong screen laptop monitor output display configuration confidence livestream",answer:"<h3>Fix Wrong Screen Output:</h3><ol><li>Open ProPresenter Preferences</li><li>Go to 'Screens' or 'Screen Configuration'</li><li>Verify displays:<ul><li><strong>Audience:</strong> HDMI Out (goes to TVs via extender)</li><li><strong>Confidence:</strong> DisplayLink virtual display #1</li><li><strong>Livestream (Camera 4):</strong> DisplayLink virtual display #2</li></ul></li><li>Drag screens to correct assignments</li><li>Click 'Apply' or 'OK'</li><li>Test with a slide</li></ol><h3>If DisplayLink screens missing:</h3><ul><li>DisplayLink wasn't launched first!</li><li>Quit ProPresenter</li><li>Launch DisplayLink, wait 15 seconds</li><li>Launch ProPresenter</li><li>Reconfigure screens</li></ul>"},
{id:4,question:"Clicker / Remote not working",category:"Remote Control",pinned:true,keywords:"clicker remote not advancing batteries usb receiver wireless presenter",answer:"<h3>Fix Clicker Not Working:</h3><ol><li><strong>Check batteries first!</strong> Replace if old</li><li>Look for USB receiver plugged into Mac Mini</li><li>Make sure receiver is visible (not blocked)</li><li>Try pressing any button to 'wake' the remote</li><li>Check LED lights on remote when pressing buttons</li></ol><h3>If still not working:</h3><ul><li>Unplug USB receiver, wait 5 seconds, plug back in</li><li>Turn remote OFF then ON</li><li>Try re-pairing (hold pairing button on receiver + remote)</li><li>Test in a different USB port</li></ul><h3>Backup:</h3><p>Use arrow keys on keyboard (→ for next slide, ← for previous)</p>"},
{id:5,question:"Lyrics not showing / black box instead",category:"Content",pinned:true,keywords:"lyrics words text missing black box blank song overlay camera 4 displaylink",answer:"<h3>Fix Missing Lyrics:</h3><ol><li>Check you selected the correct slide (not blank)</li><li>Look at preview - do you see lyrics there?</li><li>Check text isn't white-on-white or hidden</li><li>Verify layer isn't turned off</li><li>Try re-triggering the slide</li></ol><h3>If preview shows lyrics but screen doesn't:</h3><ul><li>Check output is enabled</li><li>Verify correct screen configuration</li><li>Try restarting ProPresenter</li></ul><h3>If livestream overlay (Camera 4) not working:</h3><ul><li>DisplayLink not running!</li><li>Quit ProPresenter</li><li>Launch DisplayLink FIRST</li><li>Then launch ProPresenter</li><li>Check Camera 4 in livestream software</li></ul>"},
{id:6,question:"ProPresenter won't launch / crashes",category:"ProPresenter",pinned:true,keywords:"crash wont open launch frozen stuck not starting mac mini",answer:"<h3>Fix ProPresenter Not Opening:</h3><ol><li>Wait 30 seconds (may be loading)</li><li>Check Activity Monitor - force quit if frozen</li><li>Try launching again</li><li>Restart the Mac Mini</li><li>Check for macOS updates</li></ol><h3>If crashes immediately:</h3><ul><li>Hold SHIFT while opening ProPresenter (safe mode)</li><li>Clear preferences/cache</li><li>Check ProPresenter is up to date</li><li>Verify license is activated</li></ul><h3>⚠️ Remember:</h3><p>Always launch DisplayLink BEFORE ProPresenter! Use the Sunday Setup app to do this automatically.</p>"},
{id:7,question:"Lobby screen switching issues",category:"Display",pinned:false,keywords:"lobby switch hdmi toggle livestream slides not switching stuck",answer:"<h3>Lobby HDMI Switch:</h3><p>The lobby has an HDMI switch that toggles between:</p><ul><li><strong>Input 1:</strong> Livestream feed</li><li><strong>Input 2:</strong> Direct slides from HDMI extender</li></ul><h3>If switch not working:</h3><ol><li>Check switch has power</li><li>Press button firmly (may need 2-3 second hold)</li><li>Check indicator light shows active input</li><li>Try unplugging switch for 10 seconds</li></ol><h3>If stuck on one input:</h3><ul><li>Power cycle the switch</li><li>Check both HDMI cables are firmly connected</li><li>Try pressing button multiple times</li></ul>"},
{id:8,question:"DisplayLink / Camera 4 not working",category:"Display",pinned:false,keywords:"displaylink camera 4 no signal desktop mac mini virtual display confidence livestream overlay",answer:"<h3>⚠️ MOST COMMON ISSUE!</h3><p><strong>DisplayLink MUST launch BEFORE ProPresenter!</strong></p><h3>If Camera 4 shows no signal:</h3><ol><li>Quit ProPresenter completely</li><li>Quit DisplayLink</li><li>Launch DisplayLink Manager</li><li>Wait 15 seconds for virtual displays to initialize</li><li>Launch ProPresenter</li><li>Go to Screen Configuration</li><li>Assign DisplayLink displays correctly</li></ol><h3>If shows Mac Mini desktop:</h3><p>Same fix as above - wrong launch order!</p><h3>Confidence monitor also blank?</h3><p>Same issue - it's also on DisplayLink. Follow same steps.</p><h3>💡 TIP:</h3><p>Use the <strong>Sunday Setup</strong> automation app! It launches DisplayLink before ProPresenter automatically.</p>"},
{id:9,question:"HDMI Extender not working",category:"Display",pinned:false,keywords:"hdmi extender ethernet not working tvs no signal power",answer:"<h3>Fix HDMI Extender:</h3><ol><li>Check power on SENDER (by Mac Mini)</li><li>Check power on RECEIVER (by TVs)</li><li>Look for link lights on both units</li><li>Check ethernet cable between sender/receiver</li><li>Power cycle BOTH units (unplug 10 seconds)</li></ol><h3>⚠️ WARNING:</h3><p><strong>Power cycling will cut video to ALL TVs temporarily!</strong></p><h3>If TVs still blank after power cycle:</h3><ul><li>Check HDMI from Mac Mini to sender</li><li>Check HDMI from receiver to TV splitter</li><li>Try different HDMI cable</li><li>Check Mac Mini display output settings</li></ul>"},
{id:10,question:"Confidence monitor not showing",category:"Display",pinned:false,keywords:"confidence stage display monitor pastor speaker notes not working displaylink",answer:"<h3>Fix Confidence Monitor:</h3><ol><li>Check monitor is powered on</li><li>Check HDMI/cable connection</li><li>Verify DisplayLink is running</li><li>Open ProPresenter Screen Configuration</li><li>Assign confidence display to DisplayLink virtual display #1</li><li>Enable Stage Display in ProPresenter</li></ol><h3>If still not working:</h3><ul><li>Quit ProPresenter</li><li>Quit DisplayLink</li><li>Launch DisplayLink FIRST (wait 15 seconds)</li><li>Launch ProPresenter SECOND</li><li>Reconfigure screen assignments</li></ul><h3>💡 TIP:</h3><p>Use the <strong>Sunday Setup</strong> app to launch everything in the correct order automatically!</p><h3>Confidence display options:</h3><ul><li>Current + Next slide</li><li>Notes + Current slide</li><li>Clock + Slides</li></ul>"},
{id:11,question:"One TV not showing signal",category:"Display",pinned:false,keywords:"single tv no signal one screen blank individual hdmi input",answer:"<h3>Fix Single TV No Signal:</h3><ol><li>Check which HDMI port has cable (back of TV)</li><li>Press Input/Source on TV remote</li><li>Select matching HDMI (1, 2, or 3)</li><li>Wait a few seconds for signal</li></ol><h3>If still no signal:</h3><ul><li>Check HDMI cable firmly plugged in both ends</li><li>Try different HDMI port on TV</li><li>Test with different HDMI cable</li><li>Check if other TVs are working (rules out extender)</li></ul><h3>TV-specific issue?</h3><ul><li>Power cycle that TV</li><li>Check TV isn't in sleep/standby mode</li></ul>"},
{id:12,question:"All TVs showing no signal",category:"Display",pinned:false,keywords:"all tvs blank no signal multiple screens hdmi extender",answer:"<h3>If ALL TVs are blank:</h3><p><strong>This is an HDMI Extender or Mac Mini output issue.</strong></p><ol><li>Check Mac Mini is awake and on</li><li>Verify ProPresenter output is enabled</li><li>Check HDMI Extender power (sender + receiver)</li><li>Look for link lights on extender units</li><li>Check HDMI cable from Mac Mini to extender sender</li></ol><h3>Power cycle extender:</h3><ol><li>Unplug power from sender (by Mac Mini)</li><li>Unplug power from receiver (by TVs)</li><li>Wait 10 seconds</li><li>Plug sender back in first</li><li>Plug receiver back in</li><li>Wait for link lights to establish</li></ol>"},
{id:13,question:"Can't download playlist from Google Drive",category:"Content",pinned:false,keywords:"google drive download playlist message file missing sunday setup",answer:"<h3>Fix Download Issues:</h3><ol><li>Check internet connection on Mac Mini</li><li>Verify you're logged into Google Drive</li><li>Look for this week's folder in Drive</li><li>Check files aren't still being uploaded</li><li>Try refreshing the page (⌘+R)</li></ol><h3>If files are missing:</h3><ul><li>Check you're looking at the correct Sunday date</li><li>Contact whoever uploads the playlists</li><li>Check your email for shared links</li></ul><h3>💡 TIP:</h3><p>The <strong>Sunday Setup</strong> app automatically opens the correct Google Drive folder!</p>"},
{id:14,question:"Display stretched / wrong aspect ratio",category:"Display",pinned:false,keywords:"stretched squished aspect ratio resolution wide distorted screen",answer:"<h3>Fix Stretched Display:</h3><ol><li>Check TV aspect ratio setting (16:9 vs 4:3)</li><li>Open System Preferences → Displays on Mac Mini</li><li>Select correct resolution for display</li><li>In ProPresenter Screen Configuration, verify output resolution</li><li>Check 'Maintain Aspect Ratio' is enabled</li></ol><h3>Recommended resolutions:</h3><ul><li>1920x1080 (Full HD 16:9) - most common</li><li>1280x720 (HD 16:9)</li></ul>"},
{id:15,question:"Slides advancing too slowly / lag",category:"ProPresenter",pinned:false,keywords:"slow lag delay freeze performance sluggish mac mini",answer:"<h3>Fix Slow Performance:</h3><ol><li>Close other applications on Mac Mini</li><li>Check CPU usage in Activity Monitor</li><li>Reduce slide transitions/effects</li><li>Clear media cache in ProPresenter</li><li>Lower output resolution if possible</li><li>Disable background video if not needed</li></ol><h3>For better performance:</h3><ul><li>Use solid backgrounds instead of videos</li><li>Optimize image sizes before importing</li><li>Keep ProPresenter updated</li><li>Restart Mac Mini before service</li><li>Close Chrome/Safari tabs</li></ul>"},
{id:16,question:"Can't combine playlist and message",category:"Content",pinned:false,keywords:"combine playlist message merge files propresenter",answer:"<h3>Combine Playlist and Message:</h3><ol><li>Open both files in ProPresenter</li><li>Select all slides from message file (⌘+A)</li><li>Copy slides (⌘+C)</li><li>Go to playlist file</li><li>Click where you want to insert message</li><li>Paste slides (⌘+V)</li></ol><h3>Alternative method:</h3><ul><li>Drag slides from message window into playlist</li><li>Drop them in the correct position</li><li>Save the combined playlist</li></ul><h3>💡 TIP:</h3><p>Make sure message goes in the correct spot in the service order!</p>"},
{id:17,question:"Text too small on screen",category:"Content",pinned:false,keywords:"text small font size tiny cant read",answer:"<h3>Fix Small Text:</h3><ol><li>Select the slide/text box in ProPresenter</li><li>Increase font size</li><li>Check text scaling settings</li><li>Verify output resolution matches screen</li><li>Use 'Fit to Screen' option if available</li></ol><h3>Best practices:</h3><ul><li>Minimum 36pt font for readability</li><li>Use high contrast (white text on dark background)</li><li>Keep text lines short and simple</li><li>Test from back of room before service</li><li>Remember: TVs are further away than you think!</li></ul>"},
{id:18,question:"Background video not playing",category:"Content",pinned:false,keywords:"video background not playing frozen stuck media mac mini",answer:"<h3>Fix Video Background:</h3><ol><li>Check video file format (MP4/MOV recommended)</li><li>Verify video isn't corrupted (test in QuickTime)</li><li>Check 'Play Video' option is enabled on slide</li><li>Look for codec issues</li><li>Try re-importing video</li><li>Reduce video quality if file is too large</li></ol><h3>If video lags:</h3><ul><li>Convert to H.264 codec</li><li>Lower resolution (720p usually sufficient)</li><li>Close other applications on Mac Mini</li><li>Check Mac Mini storage isn't full</li></ul>"},
{id:19,question:"Bible verses not displaying correctly",category:"Content",pinned:false,keywords:"bible scripture verses text formatting reference translation",answer:"<h3>Fix Bible Display:</h3><ol><li>Check Bible module is installed in ProPresenter</li><li>Verify correct translation selected (ESV, NIV, etc)</li><li>Look for verse reference errors</li><li>Check text formatting/template</li><li>Verify verse breaks are correct</li></ol><h3>Common issues:</h3><ul><li>Wrong translation selected</li><li>Verse reference typo (John 3:16 not John 3:161)</li><li>Template needs font size adjustment</li><li>Font color matches background (can't see it)</li></ul>"},
{id:20,question:"Presentation freezes during service",category:"ProPresenter",pinned:false,keywords:"freeze frozen crash hang stuck during service emergency mac mini",answer:"<h3>If ProPresenter Freezes During Service:</h3><ol><li><strong>Don't panic</strong> - audience may not notice yet</li><li>Try clicking a different slide</li><li>Press ESC to clear current slide</li><li>Press arrow keys to advance</li><li>If totally frozen, check Activity Monitor (⌘+Space, type Activity Monitor)</li><li>Force quit ProPresenter if necessary</li><li>Relaunch immediately</li><li>Load most recent playlist</li></ol><h3>⚠️ Remember after relaunch:</h3><p>You may need to reconfigure displays if DisplayLink was affected</p><h3>Prevention:</h3><ul><li>Close unnecessary apps before service</li><li>Restart Mac Mini weekly</li><li>Keep ProPresenter updated</li><li>Test all media before service</li></ul>"},
{id:21,question:"Sunday Setup app not working",category:"Setup",pinned:false,keywords:"sunday setup automation app not opening google drive displaylink propresenter",answer:"<h3>If Sunday Setup App Fails:</h3><ol><li>Try running it again (may have timeout issue)</li><li>Check internet connection</li><li>Manually launch in correct order:<ul><li>Open Google Drive folder</li><li>Launch DisplayLink Manager (wait 15 seconds)</li><li>Launch ProPresenter</li></ul></li></ol><h3>If Google Drive won't open:</h3><ul><li>Check you're logged into Google account</li><li>Try opening Drive manually in browser</li><li>Verify internet connection is working</li></ul><h3>If DisplayLink won't launch:</h3><ul><li>Check DisplayLink Manager is installed</li><li>Try launching manually from Applications</li><li>Restart Mac Mini if necessary</li></ul>"}
];

const advancedSynonyms={
    display:['screen','monitor','output','showing','tv','tvs'],
    blank:['black','nothing','empty','dark','no display'],
    propresenter:['pro presenter','pp','pro7','software','program'],
    slide:['slides','presentation','slideshow'],
    clicker:['remote','controller','advance','presenter'],
    lyrics:['words','text','song','worship'],
    video:['media','movie','clip','background'],
    computer:['laptop','mac','pc','machine','mac mini'],
    wrong:['incorrect','bad','different'],
    frozen:['freeze','stuck','hang','crash','locked'],
    setup:['start','startup','turn on','boot','sunday setup','automation'],
    bible:['scripture','verse','verses','passage'],
    stage:['confidence','monitor','pastor screen'],
    playlist:['presentation','service','order','sunday'],
    download:['get','grab','pull','fetch'],
    combine:['merge','join','put together','mix']
};

const problemPatterns = [
    {pattern: /no (display|screen|output|showing)/i, boost: ['blank', 'display', 'output', 'enable']},
    {pattern: /(blank|black|nothing|empty).*(screen|display)/i, boost: ['blank', 'display', 'output']},
    {pattern: /(wrong|incorrect|different).*(screen|display|monitor)/i, boost: ['wrong screen', 'configuration', 'output']},
    {pattern: /(clicker|remote|advance).*(not work|broken|won't)/i, boost: ['clicker', 'remote', 'batteries', 'usb']},
    {pattern: /(lyrics|words|text).*(missing|not show|blank)/i, boost: ['lyrics', 'text', 'missing', 'layer']},
    {pattern: /(freeze|frozen|crash|stuck|hang)/i, boost: ['freeze', 'crash', 'frozen', 'force quit']},
    {pattern: /stretched|aspect|distorted|squished/i, boost: ['stretched', 'aspect ratio', 'resolution']},
    {pattern: /(slow|lag|delay|sluggish)/i, boost: ['slow', 'performance', 'lag']},
    {pattern: /(can't find|missing|lost).*(presentation|playlist)/i, boost: ['missing', 'saved', 'file', 'playlist']},
    {pattern: /(can't|won't|not).*(download|get)/i, boost: ['download', 'google drive', 'playlist']},
    {pattern: /(combine|merge|join).*(playlist|message)/i, boost: ['combine', 'playlist', 'message']},
    {pattern: /(text|font).*(small|tiny|can't read)/i, boost: ['text', 'font size', 'small']},
    {pattern: /(video|background).*(not play|frozen|stuck)/i, boost: ['video', 'background', 'media']},
    {pattern: /stage (display|screen|monitor)/i, boost: ['stage display', 'confidence', 'monitor']},
    {pattern: /license|activation|trial|expired/i, boost: ['license', 'activation', 'registration']},
    {pattern: /(bible|scripture|verse)/i, boost: ['bible', 'verses', 'scripture']},
    {pattern: /(timer|countdown|clock)/i, boost: ['timer', 'countdown', 'clock']},
    {pattern: /(audio|sound).*(video)/i, boost: ['audio', 'video', 'sound', 'muted']},
    {pattern: /mirror|duplicate/i, boost: ['mirror', 'duplicate', 'displays']},
    {pattern: /sunday setup|automation/i, boost: ['sunday setup', 'automation', 'google drive', 'displaylink']}
];

const emergencyMap={'no-display':2,'wrong-screen':3,'not-advancing':4};
let recentSearches=[];
const MAX_RECENT=5;

function loadRecentSearches(){const stored={};if(stored.recentSearches){recentSearches=stored.recentSearches;}}
function saveRecentSearch(query){if(!query||query.length<2)return;query=query.trim().toLowerCase();recentSearches=recentSearches.filter(s=>s!==query);recentSearches.unshift(query);recentSearches=recentSearches.slice(0,MAX_RECENT);renderRecentSearches();}
function renderRecentSearches(){const container=document.getElementById('recentSearches');const tagsContainer=document.getElementById('recentTags');if(recentSearches.length===0){container.style.display='none';return;}container.style.display='block';tagsContainer.innerHTML=recentSearches.map(search=>`<span class="recent-tag" onclick="applyRecentSearch('${search}')">${search}</span>`).join('')+'<button class="clear-recent" onclick="clearRecentSearches()">Clear</button>';}
function applyRecentSearch(query){document.getElementById('searchBar').value=query;currentSearch=query;renderAll();}
function clearRecentSearches(){recentSearches=[];renderRecentSearches();}
function expandSearchQuery(query){let words=query.toLowerCase().split(/\s+/).filter(w=>w.length>0);const stopWords=['a','an','the','or','and','on','in','at','to','for','of','is','are'];words=words.filter(w=>!stopWords.includes(w)&&w!=='/');let expanded=new Set(words);words.forEach(word=>{if(advancedSynonyms[word]){advancedSynonyms[word].forEach(syn=>expanded.add(syn));}Object.keys(advancedSynonyms).forEach(key=>{if(advancedSynonyms[key].includes(word)){expanded.add(key);advancedSynonyms[key].forEach(syn=>expanded.add(syn));}});});problemPatterns.forEach(({pattern,boost})=>{if(pattern.test(query)){boost.forEach(term=>expanded.add(term));}});return Array.from(expanded).join(' ');}
function highlightText(text,searchTerms){if(!searchTerms||searchTerms.length===0)return text;const stopWords=['a','an','the','or','and','on','in','at','to','for','of','is','are'];const termsToHighlight=searchTerms.filter(term=>!stopWords.includes(term.toLowerCase())&&term.length>1);let result=text;termsToHighlight.forEach(term=>{if(term.length<2)return;const regex=new RegExp(`(${term})`,'gi');result=result.replace(regex,'<span class="highlight">$1</span>');});return result;}
function intelligentSearch(query){if(!query)return faqData;const originalQuery=query;const expandedQuery=expandSearchQuery(query);const stopWords=['a','an','the','or','and','on','in','at','to','for','of','is','are'];const searchTerms=query.toLowerCase().split(/\s+/).filter(w=>w.length>1&&!stopWords.includes(w));const fuse=new Fuse(faqData,{keys:[{name:'question',weight:0.45},{name:'keywords',weight:0.45},{name:'answer',weight:0.1}],threshold:0.45,includeScore:true,ignoreLocation:true,minMatchCharLength:2,distance:150,useExtendedSearch:true});let results=fuse.search(expandedQuery);if(results.length<3){const altResults=fuse.search(originalQuery);results=[...results,...altResults].filter((v,i,a)=>a.findIndex(t=>t.item.id===v.item.id)===i);}results=results.map(r=>({...r.item,score:r.score,searchTerms:searchTerms}));results.forEach(result=>{let bonusScore=0;const questionLower=result.question.toLowerCase();const keywordsLower=result.keywords.toLowerCase();const answerLower=result.answer.replace(/<[^>]*>/g,'').toLowerCase();if(questionLower.includes(originalQuery.toLowerCase())){bonusScore-=0.5;}if(keywordsLower.includes(originalQuery.toLowerCase())){bonusScore-=0.4;}searchTerms.forEach((term,index)=>{const isImportantTerm=term.length>4||['slide','remote'].includes(term);const multiplier=isImportantTerm?1.5:1.0;const positionBonus=index===0?1.2:1.0;if(questionLower.includes(term)){bonusScore-=0.25*multiplier*positionBonus;}if(keywordsLower.includes(term)){bonusScore-=0.2*multiplier*positionBonus;}const answerMatches=(answerLower.match(new RegExp('\\b'+term+'\\b','g'))||[]).length;bonusScore-=answerMatches*0.04;});if(result.pinned)bonusScore-=0.12;const allTermsInQuestion=searchTerms.every(term=>questionLower.includes(term));if(allTermsInQuestion)bonusScore-=0.4;const allTermsInKeywords=searchTerms.every(term=>keywordsLower.includes(term));if(allTermsInKeywords)bonusScore-=0.35;result.score+=bonusScore;});results.sort((a,b)=>a.score-b.score);return results;}

let suggestionTimeout;
function showSuggestions(query){clearTimeout(suggestionTimeout);if(!query||query.length<2){document.getElementById('suggestionsDropdown').classList.remove('active');return;}suggestionTimeout=setTimeout(()=>{const results=intelligentSearch(query).slice(0,5);const dropdown=document.getElementById('suggestionsDropdown');if(results.length===0){dropdown.classList.remove('active');return;}dropdown.innerHTML=results.map((faq,index)=>{const cleanAnswer=faq.answer.replace(/<\/?(h3|ol|ul|li|p|strong)[^>]*>/gi,' ').replace(/<[^>]*>/g,'').replace(/\s+/g,' ').trim();const preview=cleanAnswer.substring(0,80)+'...';const highlightedQuestion=highlightText(faq.question,faq.searchTerms);return`<div class="suggestion-item" data-index="${index}" data-id="${faq.id}"><div class="suggestion-question">${highlightedQuestion}</div><div class="suggestion-preview">${preview}</div><span class="suggestion-category">${faq.category}</span></div>`;}).join('');dropdown.classList.add('active');dropdown.querySelectorAll('.suggestion-item').forEach(item=>{item.addEventListener('click',()=>{const faqId=parseInt(item.dataset.id);const faq=faqData.find(f=>f.id===faqId);if(faq){document.getElementById('searchBar').value=faq.question;currentSearch=faq.question;saveRecentSearch(query);renderAll();dropdown.classList.remove('active');setTimeout(()=>{const faqElement=document.querySelector(`.faq-item[data-id="${faqId}"]`);if(faqElement){faqElement.scrollIntoView({behavior:'smooth',block:'center'});faqElement.click();}},100);}});});},200);}

let currentCategory='all';
let currentSearch='';

function convertToCheckboxes(htmlContent){const parser=new DOMParser();const doc=parser.parseFromString(htmlContent,'text/html');doc.querySelectorAll('ol li, ul li').forEach((li,index)=>{const checkbox=document.createElement('input');checkbox.type='checkbox';checkbox.id=`step-${Date.now()}-${index}`;const label=document.createElement('label');label.htmlFor=checkbox.id;label.innerHTML=li.innerHTML;const wrapper=document.createElement('div');wrapper.className='step-checkbox';wrapper.appendChild(checkbox);wrapper.appendChild(label);checkbox.addEventListener('change',(e)=>{if(e.target.checked){wrapper.classList.add('completed');}else{wrapper.classList.remove('completed');}});li.parentNode.replaceChild(wrapper,li);});return doc.body.innerHTML;}

function renderFAQ(faq,container){const item=document.createElement('div');item.className=`faq-item ${faq.pinned?'pinned':''}`;item.dataset.id=faq.id;const cleanAnswer=faq.answer.replace(/<\/?(h3|ol|ul|li|p|strong)[^>]*>/gi,' ').replace(/<[^>]*>/g,'').replace(/\s+/g,' ').trim();const preview=cleanAnswer.substring(0,120)+'...';const highlightedQuestion=faq.searchTerms?highlightText(faq.question,faq.searchTerms):faq.question;const highlightedPreview=faq.searchTerms?highlightText(preview,faq.searchTerms):preview;const answerWithCheckboxes=convertToCheckboxes(faq.answer);item.innerHTML=`<div class="faq-question"><span>${highlightedQuestion}</span><span class="expand-icon">▼</span></div><span class="faq-category">${faq.category}</span><div class="faq-preview">${highlightedPreview}</div><div class="faq-answer">${answerWithCheckboxes}<div class="feedback-section"><div class="feedback-question">Did this solve your problem?</div><div class="feedback-buttons"><button class="feedback-btn yes">✓ Yes, it worked!</button><button class="feedback-btn no">✗ No, still broken</button></div><div class="feedback-thanks"></div></div></div>`;item.onclick=(e)=>{if(e.target.closest('.step-checkbox')||e.target.closest('.feedback-section')){return;}const isExpanded=item.classList.contains('expanded');document.querySelectorAll('.faq-answer').forEach(a=>a.classList.remove('expanded'));document.querySelectorAll('.faq-item').forEach(i=>i.classList.remove('expanded'));if(!isExpanded){item.classList.add('expanded');item.querySelector('.faq-answer').classList.add('expanded');}};const yesBtn=item.querySelector('.feedback-btn.yes');const noBtn=item.querySelector('.feedback-btn.no');const thanksMsg=item.querySelector('.feedback-thanks');const feedbackBtns=item.querySelector('.feedback-buttons');yesBtn.onclick=(e)=>{e.stopPropagation();feedbackBtns.style.display='none';thanksMsg.textContent='✓ Great! Glad we could help!';thanksMsg.classList.add('show');};noBtn.onclick=(e)=>{e.stopPropagation();feedbackBtns.style.display='none';thanksMsg.textContent='🔧 Please report this issue so we can improve!';thanksMsg.style.color='#fbbf24';thanksMsg.classList.add('show');setTimeout(()=>{document.getElementById('reportBtn').click();},1500);};container.appendChild(item);}

function renderAll(){document.getElementById('pinnedList').innerHTML='';document.getElementById('faqList').innerHTML='';document.getElementById('suggestionsDropdown').classList.remove('active');let filtered=faqData;if(currentCategory!=='all'){filtered=faqData.filter(f=>f.category===currentCategory);}if(currentSearch){filtered=intelligentSearch(currentSearch);document.getElementById('pinnedSection').style.display='none';document.getElementById('emergencyActions').style.display='none';if(filtered.length===0){document.getElementById('noResults').style.display='block';document.getElementById('faqList').style.display='none';document.getElementById('searchStats').textContent='';return;}else{document.getElementById('noResults').style.display='none';document.getElementById('faqList').style.display='flex';document.getElementById('searchStats').textContent=`Found ${filtered.length} result${filtered.length!==1?'s':''}`;}filtered.forEach(f=>renderFAQ(f,document.getElementById('faqList')));saveRecentSearch(currentSearch);}else{document.getElementById('pinnedSection').style.display='block';document.getElementById('emergencyActions').style.display='grid';document.getElementById('noResults').style.display='none';document.getElementById('faqList').style.display='flex';document.getElementById('searchStats').textContent='';const pinned=filtered.filter(f=>f.pinned);pinned.forEach(f=>renderFAQ(f,document.getElementById('pinnedList')));filtered.filter(f=>!f.pinned).forEach(f=>renderFAQ(f,document.getElementById('faqList')));}}

const searchBar=document.getElementById('searchBar');
const clearSearchBtn=document.getElementById('clearSearch');
const searchIcon=document.getElementById('searchIcon');

searchBar.addEventListener('input',e=>{currentSearch=e.target.value.trim();if(e.target.value){clearSearchBtn.classList.add('active');searchIcon.style.display='none';}else{clearSearchBtn.classList.remove('active');searchIcon.style.display='block';}showSuggestions(currentSearch);if(!currentSearch)renderAll();});

searchBar.addEventListener('keydown',e=>{if(e.key==='Enter'){renderAll();}});

clearSearchBtn.addEventListener('click',()=>{searchBar.value='';currentSearch='';clearSearchBtn.classList.remove('active');searchIcon.style.display='block';renderAll();searchBar.focus();});

document.addEventListener('click',e=>{if(!e.target.closest('.search-container')){document.getElementById('suggestionsDropdown').classList.remove('active');}});

document.querySelectorAll('.category-btn').forEach(btn=>btn.onclick=()=>{document.querySelectorAll('.category-btn').forEach(b=>b.classList.remove('active'));btn.classList.add('active');currentCategory=btn.dataset.category;document.getElementById('searchBar').value='';currentSearch='';renderAll();});

document.querySelectorAll('.emergency-btn').forEach(btn=>{btn.addEventListener('click',()=>{const issueType=btn.dataset.issue;const faqId=emergencyMap[issueType];const faq=faqData.find(f=>f.id===faqId);if(faq){document.getElementById('searchBar').value=faq.question;currentSearch=faq.question;renderAll();setTimeout(()=>{const faqElement=document.querySelector(`.faq-item[data-id="${faqId}"]`);if(faqElement){faqElement.scrollIntoView({behavior:'smooth',block:'center'});faqElement.click();}},100);}});});

document.getElementById('reportBtn').onclick=e=>{e.preventDefault();document.getElementById('contactModal').style.display='block';};

document.getElementById('cancelBtn').onclick=()=>{document.getElementById('contactModal').style.display='none';};

document.getElementById('contactModal').onclick=e=>{if(e.target.id==='contactModal'){document.getElementById('contactModal').style.display='none';}};

document.getElementById('contactForm').onsubmit=async e=>{e.preventDefault();const res=await fetch(e.target.action,{method:'POST',body:new FormData(e.target),headers:{'Accept':'application/json'}});if(res.ok){document.getElementById('contactForm').style.display='none';document.getElementById('successMessage').style.display='block';setTimeout(()=>document.getElementById('contactModal').style.display='none',3000);}};

loadRecentSearches();
renderRecentSearches();
renderAll();
    </script>
</body>
</html>